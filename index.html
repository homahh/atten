<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="referrer" content="no-referrer">
        <link rel="icon" href="data:image/png;base64,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">
        <title>Attendance for UTM</title>
        <style>
            body {
                font-family: sans-serif !important;
                font-weight: 900;
                margin: 0;
                padding: 0;
                background-image: url("bg1.jpg");
            }
            
            input {
                outline: none;
                border: none;
                font-weight: 700;
            }

            label {
                display: block;
                margin: 0;
            }

            button {
                outline: none !important;
                border: none;
                font-weight: 700;
            }

            button:hover {
                cursor: pointer;
                background: #db07f7;
            }

            .container-login {
                min-height: 75vh;
                display: -webkit-box;
                display: -webkit-flex;
                display: -moz-box;
                display: -ms-flexbox;
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
            }

            .wrap-login {
                width: 400px;
                border-radius: 10px;
                position: relative;
            }

            .form {
                width: 100%;
            }

            .form-title {
                font-size: 40px;
                line-height: 1.2;
                text-align: center;
                margin-bottom: 5%;
                width: 100%;
                display: block;
            }

            .wrap-input {
                width: 100%;
                position: relative;
                background-color: #fffbfb;
                border: 1px solid transparent;
                border-radius: 3px;
            }

            .input {
                line-height: 1.2;
                font-size: 18px;
                display: block;
                outline: none;
                border: none;
                font-weight: 700;
                color: #696969;
                width: 100%;
                background: transparent;
                height: 62px;
                padding: 0 10px;
            }

            .container-form-btn {
                width: 100%;
                display: -webkit-box;
                display: -webkit-flex;
                display: -moz-box;
                display: -ms-flexbox;
                display: flex;
                flex-wrap: wrap;
            }

            .form-btn {
                font-size: 16px;
                color: #fff;
                text-transform: uppercase;
                padding: 0 20px;
                width: 100%;
                height: 62px;
                background-color: #64001c;
                border-radius: 3px;
                -webkit-transition: all 0.4s;
                -o-transition: all 0.4s;
                -moz-transition: all 0.4s;
                transition: all 0.4s;
            }
            #result{
                text-align: center;
                font-family: monospace;
                margin: 15px;
            }
            @media only screen and (max-device-width: 640px) {
                .wrap-login {
                    width: 80%;
                }
                .form-title{
                    font-size: 3em;
                }
                .wrap-input > *, .form-btn{
                    height: 3em;
                    font-size: 2em;
                }
                #result{
                    padding-top: 20px;
                    font-size: 2em;
                }
            }
        </style>
    </head>
    <body>
        <div class="limiter">
            <div class="container-login">
                <div class="wrap-login">
                    <form class="form" action="javascript:void(0)">
                        <span class="form-title">
                            ATTENDANCE <small><small></small></small>
                        </span>
                        <br>
                        <br>
                        <div class="wrap-input">
                            <select name="key" class="input" id="code">
                                <option>Course</option>
                                <option value="WS9oNXRIZ2hNUDFCUUNJUWZHMitwbW1sc3ZFZEw1VGpGZHR4WmdCZG5FOD0=">NETWORK PROGRAMMING</option>
                                <option value="R1RlZEYxUUVrL1FaVmVZWnZ4WStaYndNLzYrQlFNRlMzSjF1ZDAwd3FvRT0=">SECURE PROGRAMMING</option>
                                <option value="TStSSENZdnJpaUZoVmhaTmUvVTFsbDNHQmUxRHRRT2lNRG42UzJvV1djND0=">TECHNOPRENEURSHIP SEMINAR</option>
                                <option value="UktXVGZzcjFnSmxUeFZ0SWRiNUszbGNjWDV0ZFBYdytOUnJKbEhEYlF4dz0=">COMPUTER SCIENCE THEORY</option>
                                <option value="RjY1K3EzMmtPRkNSWU4yRHJhbjlTL0JCL2lrOTFuaFA0TkYvWUZXOVZuST0=">PROBABILITY & STATISTICAL DATA ANALYSIS</option>
                                <option value="bHpCN3ZwVFZqbzNxcHdLL0lpVkw0a3B1ZE45MXp5aC9IaHBZUjcrZFdLND0=">ACADEMIC COMMUNICATION SKILLS</option>
                            </select>
                        </div>
                        <br>
                        <div class="wrap-input">
                            <input class="input" id="matric" name="barcode" placeholder="Matric">
                        </div>
                        <br>
                        <div class="container-form-btn">
                            <button class="form-btn" onclick="AttendAll()">
                                Submit
                            </button>
                        </div>
                    </form>
                    <div id="result"></div>
                    <script>
                        var code,
                            saif = 'A19EC3030';

                        function AttendAll(){
                            document.getElementById("result").innerHTML = "";
                            code = document.getElementById('code').value;
                            let mtrc = document.getElementById('matric').value;

                            if (/^(NAD)/.test(code)){
                                attend([saif]);
                            } else if (/^(bH)/.test(code)){
                                attend([saif]);
                            } else {
                                attend([saif]);
                            }
                            
                            if (/^(A1)/.test(mtrc)) attend([mtrc]);
                        }
                        
                        async function attend(id){
                            for(i=0;i<id.length; i++){
                               let xhttp = new XMLHttpRequest();
                                xhttp.onreadystatechange = function() {
                                    if (this.readyState == 4 && this.status == 200) {
                                        if(/Your attendance for following class has been recorded./.test(this.response)){
                                            var elem = document.createElement('div');
                                            elem.innerHTML = this.response.trim();
                                            name = elem.querySelector('#MainContent_BodyContent_lblSName').textContent.split(" ",2).join(" "); 
                                            document.getElementById("result").innerHTML += `Taken for: ${name}<br>`;
                                        }
                                    }else if(/Attendance Is Closed./.test(this.response)){
                                        document.getElementById("result").innerHTML = "<font color='red'>Attendance is closed</font>";
                                    }
                                    
                                }
                                xhttp.open("GET", "http://academic.utm.my/MobileAttandence/SlideInClass.aspx?key="+code+"&barcode="+id[i], true);
                                xhttp.send();
                                await sleep();
                            }
                        }
                        function sleep() {
                            return new Promise(resolve => setTimeout(resolve, Math.floor(Math.random() * 3)*1000+3000));
                        }
                    </script>
                </div>
            </div>
        </div>
</body>